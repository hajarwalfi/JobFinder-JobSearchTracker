<section
  class="relative isolate min-h-screen overflow-hidden bg-gradient-to-br from-[#FFF8EF] via-[#FFF2E7] to-white px-4 py-16 text-slate-900"
>
  <div class="pointer-events-none absolute inset-0 opacity-80">
    <div class="absolute -left-24 top-16 h-96 w-96 rounded-full bg-[#FFBC7D]/30 blur-3xl"></div>
    <div
      class="absolute -right-32 bottom-0 h-[28rem] w-[28rem] rounded-full bg-[#FDB4C0]/30 blur-3xl"
    ></div>
    <div class="absolute inset-x-0 top-0 h-40 bg-gradient-to-b from-white/30"></div>
  </div>

  <div class="relative mx-auto max-w-6xl space-y-10">
    <!-- Profile Header Card -->
    <div
      class="rounded-[2.5rem] border border-white/80 bg-white/90 p-8 shadow-[0_25px_90px_-45px_rgba(15,23,42,0.25)]"
    >
      <div class="flex flex-wrap items-center justify-between gap-6">
        <div class="flex items-center gap-5">
          <div
            class="flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-r from-[#FF9653] to-[#FF6E62] text-xl font-bold text-white shadow-[0_15px_45px_rgba(255,140,102,0.4)]"
          >
            {{ user?.firstName?.charAt(0) || '' }}{{ user?.lastName?.charAt(0) || '' }}
          </div>
          <div>
            <p class="text-sm font-medium text-amber-500">
              Espace personnel
            </p>
            <h1 class="mt-1 text-2xl font-semibold text-slate-900">
              {{ user?.firstName }} {{ user?.lastName }}
            </h1>
            <p class="text-sm text-slate-500">{{ user?.email }}</p>
          </div>
        </div>
        <button
          (click)="onLogout()"
          class="flex items-center gap-2 rounded-[1.75rem] border border-white/80 bg-white px-5 py-2.5 text-sm font-semibold text-slate-700 shadow-[0_18px_45px_-28px_rgba(15,23,42,0.5)] transition hover:-translate-y-0.5 hover:text-rose-600"
        >
          <svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3-3h-9m9 0l-3-3m3 3l-3 3"
            />
          </svg>
          Déconnexion
        </button>
      </div>
    </div>

    @if (successMessage) {
      <div
        class="rounded-[2rem] border border-emerald-200 bg-emerald-50/80 px-6 py-4 text-sm font-semibold text-emerald-700"
      >
        {{ successMessage }}
      </div>
    }

    @if (errorMessage) {
      <div
        class="rounded-[2rem] border border-rose-200 bg-rose-50/80 px-6 py-4 text-sm font-semibold text-rose-600"
      >
        {{ errorMessage }}
      </div>
    }

    <!-- Content: Sidebar + Main -->
    <div class="flex flex-col gap-8 md:flex-row">
      <!-- Sidebar -->
      <nav class="w-full shrink-0 md:w-60">
        <div
          class="rounded-[2.5rem] border border-white/80 bg-white/90 p-5 shadow-[0_25px_90px_-45px_rgba(15,23,42,0.25)]"
        >
          <button
            (click)="activeTab = 'personal'"
            class="flex w-full items-center gap-3 rounded-2xl px-4 py-3 text-sm font-medium transition"
            [class]="
              activeTab === 'personal'
                ? 'border-l-4 border-[#FF9653] bg-amber-50/80 text-[#FF9653]'
                : 'text-slate-500 hover:bg-slate-50 hover:text-slate-700'
            "
          >
            <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"
              />
            </svg>
            Infos personnelles
          </button>
          <button
            (click)="activeTab = 'security'"
            class="flex w-full items-center gap-3 rounded-2xl px-4 py-3 text-sm font-medium transition"
            [class]="
              activeTab === 'security'
                ? 'border-l-4 border-[#FF9653] bg-amber-50/80 text-[#FF9653]'
                : 'text-slate-500 hover:bg-slate-50 hover:text-slate-700'
            "
          >
            <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"
              />
            </svg>
            Sécurité
          </button>
          <button
            (click)="activeTab = 'danger'"
            class="flex w-full items-center gap-3 rounded-2xl px-4 py-3 text-sm font-medium transition"
            [class]="
              activeTab === 'danger'
                ? 'border-l-4 border-rose-500 bg-rose-50/80 text-rose-500'
                : 'text-slate-500 hover:bg-slate-50 hover:text-slate-700'
            "
          >
            <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"
              />
            </svg>
            Zone dangereuse
          </button>
        </div>
      </nav>

      <!-- Main Content -->
      <div class="flex-1">
        @if (activeTab === 'personal' && user) {
          <div
            class="rounded-[2.5rem] border border-white/80 bg-white/90 p-8 shadow-[0_25px_90px_-45px_rgba(15,23,42,0.25)]"
          >
            <p class="text-sm font-medium text-amber-500">
              Profil
            </p>
            <h2 class="mt-2 text-2xl font-semibold text-slate-900">Informations personnelles</h2>
            <p class="mt-1 text-sm text-slate-500">
              Mettez à jour vos informations personnelles ici
            </p>
            <div class="mt-6">
              <app-profile-edit-form
                [user]="user"
                section="personal"
                (formSubmit)="onUpdate($event)"
              />
            </div>
          </div>
        }

        @if (activeTab === 'security' && user) {
          <div
            class="rounded-[2.5rem] border border-white/80 bg-white/90 p-8 shadow-[0_25px_90px_-45px_rgba(15,23,42,0.25)]"
          >
            <p class="text-sm font-medium text-amber-500">
              Sécurité
            </p>
            <h2 class="mt-2 text-2xl font-semibold text-slate-900">Modifier le mot de passe</h2>
            <p class="mt-1 text-sm text-slate-500">
              Sécurisez votre compte en modifiant votre mot de passe
            </p>
            <div class="mt-6">
              <app-profile-edit-form
                [user]="user"
                section="security"
                (formSubmit)="onUpdate($event)"
              />
            </div>
          </div>
        }

        @if (activeTab === 'danger') {
          <div
            class="rounded-[2.5rem] border border-rose-200/60 bg-white/90 p-8 shadow-[0_25px_90px_-45px_rgba(15,23,42,0.25)]"
          >
            <p class="text-sm font-medium text-rose-400">
              Attention
            </p>
            <h2 class="mt-2 text-2xl font-semibold text-rose-600">Zone dangereuse</h2>
            <p class="mt-2 text-sm text-slate-500">
              La suppression de votre compte est définitive et entraîne l'effacement de vos favoris
              et candidatures.
            </p>

            @if (!showDeleteConfirm) {
              <button
                (click)="showDeleteConfirm = true"
                class="mt-6 rounded-[1.75rem] border border-rose-300 px-5 py-2.5 text-sm font-semibold text-rose-600 transition hover:-translate-y-0.5 hover:bg-rose-50"
              >
                Supprimer mon compte
              </button>
            } @else {
              <div class="mt-6 flex flex-wrap gap-3">
                <button
                  (click)="onDeleteAccount()"
                  class="rounded-[1.75rem] bg-rose-600 px-5 py-2.5 text-sm font-semibold text-white shadow-[0_15px_45px_rgba(244,63,94,0.4)] transition hover:-translate-y-0.5 hover:bg-rose-700"
                >
                  Confirmer la suppression
                </button>
                <button
                  (click)="showDeleteConfirm = false"
                  class="rounded-[1.75rem] border border-white/80 bg-white px-5 py-2.5 text-sm font-semibold text-slate-600 shadow-[0_18px_45px_-28px_rgba(15,23,42,0.5)] transition hover:-translate-y-0.5"
                >
                  Annuler
                </button>
              </div>
            }
          </div>
        }
      </div>
    </div>
  </div>
</section>
