<section
  class="relative isolate min-h-screen overflow-hidden bg-gradient-to-br from-[#FFF8EF] via-[#FFF2E7] to-white px-4 py-16 text-slate-900"
>
  <div class="pointer-events-none absolute inset-0 opacity-80">
    <div class="absolute -left-24 top-16 h-96 w-96 rounded-full bg-[#FFBC7D]/30 blur-3xl"></div>
    <div
      class="absolute -right-32 bottom-0 h-[28rem] w-[28rem] rounded-full bg-[#FDB4C0]/30 blur-3xl"
    ></div>
    <div class="absolute inset-x-0 top-0 h-40 bg-gradient-to-b from-white/30"></div>
  </div>

  <div class="relative mx-auto max-w-6xl space-y-10">
    <header
      class="rounded-[2.5rem] border border-white/80 bg-white/90 p-10 shadow-[0_25px_90px_-45px_rgba(15,23,42,0.25)]"
    >
      <div class="flex flex-col gap-6 md:flex-row md:items-center md:justify-between">
        <div>
          <p class="text-xs font-semibold uppercase text-amber-500">Pipeline</p>
          <h1 class="mt-3 text-4xl font-semibold text-slate-900">Mes Candidatures</h1>
          <p class="mt-2 text-sm text-slate-500">
            Suivez chaque étape, ajustez vos notes et gardez une vision claire de vos relances.
          </p>
        </div>
        @if (applications$ | async; as apps) {
          <app-applications-stats [count]="apps.length" />
        }
      </div>
    </header>

    @if (error) {
      <div
        class="rounded-2xl border border-rose-200 bg-rose-50/80 px-6 py-5 text-sm font-semibold text-rose-600"
      >
        {{ error }}
      </div>
    }

    @if (applications$ | async; as allApplications) {
      @if (allApplications.length > 0) {
        @if (paginatedApplications$ | async; as applications) {
          <div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
            @for (app of applications; track app.id) {
              <app-application-card
                [application]="app"
                (statusChange)="onStatusChange($event)"
                (notesChange)="onNotesChange($event)"
                (remove)="onRemove($event)"
              />
            }
          </div>
        }

        @if (totalPages > 1) {
          <div class="flex items-center justify-center gap-3 pt-4">
            <button
              (click)="goToPage(currentPage - 1)"
              [disabled]="currentPage === 1"
              class="rounded-[1.75rem] border border-white/80 bg-white px-5 py-2 text-sm font-semibold text-slate-900 shadow-[0_18px_45px_-28px_rgba(15,23,42,0.5)] transition hover:-translate-y-0.5 disabled:cursor-not-allowed disabled:opacity-40"
            >
              Précédent
            </button>
            <span
              class="rounded-[1.75rem] bg-gradient-to-r from-[#FF9653] to-[#FF6E62] px-5 py-2 text-sm font-semibold text-white shadow-[0_15px_45px_rgba(255,140,102,0.6)]"
            >
              {{ currentPage }} / {{ totalPages }}
            </span>
            <button
              (click)="goToPage(currentPage + 1)"
              [disabled]="currentPage === totalPages"
              class="rounded-[1.75rem] border border-white/80 bg-white px-5 py-2 text-sm font-semibold text-slate-900 shadow-[0_18px_45px_-28px_rgba(15,23,42,0.5)] transition hover:-translate-y-0.5 disabled:cursor-not-allowed disabled:opacity-40"
            >
              Suivant
            </button>
          </div>
        }
      } @else {
        @if (!loading) {
          <div class="px-6 py-12 text-center text-slate-500">
            <p class="text-base font-semibold text-slate-600">Aucune candidature pour le moment.</p>
            <p class="mt-2 text-sm">
              Suivez une offre depuis la recherche pour commencer votre pipeline.
            </p>
          </div>
        }
      }
    }
  </div>
</section>
